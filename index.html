<!DOCTYPE html>
<html>
<head>
	<title>Assignment 10: API Fun!</title>
	<meta charset="utf-8"/>
	<link rel="stylesheet" href="style.css">

	<script type="javascript">

		function getMyData()
		{
			console.log("hello");
			//Step 1: request object made - print step credited to get-weather-ajax
			request = new XMLHTTPRequest();
			console.log("Step 1 - request object created");

			//Step 1: opened request file - print step credited to get-weather-ajax
			request.open("GET", "https://www.metaweather.com/api/location/839722/", true);
			console.log("Step 2 - opened request file");

			request.onreadystatechange = function(){
				console.log("Step 3 - readystatechange event fired.");
				if (request.readyState == 4 && request.status == 200) {
					// Step 5: wait for done + success - print step credited to get-weather-ajax
					console.log("5 - response received");

					//store the result
					var result = request.responseText;
					weather_info = JSON.parse(result);
					info = weather_info['consolidated_weather'];

					wea_state = info[0]["weather_state_name"];
					wea_curr_temp = info[0]["the_temp"];
					wea_max_temp = info[0]["max_temp"];
					wea_min_temp = info[0]["min_temp"];
					wea_humidity = info[0]["humidity"];

					document.getElementById("state").innerHTML = "Weather State: " + wea_state;
					document.getElementById("curr_temp").innerHTML = "Current Temperature (Cº): " + wea_curr_temp;
					document.getElementById("max_temp").innerHTML = "High Temp. Today (Cº): " + wea_max_temp;
					document.getElementById("min_temp").innerHTML = "Low Temp. Today (Cº): " + wea_min_temp;
					document.getElementById("humidity").innerHTML = "Humidity: " + wea_humidity;


				}
				else if (request.readyState == 4 && request.status != 200) {
					document.getElementById("weather").innerHTML = "Hmm...something went wrong when trying to read the API.";
				}

			}

			// Step 4: fire off the HTTP request - print step credited to get-weather-ajax
			request.send();
			console.log("4 - Request sent");

		}
	</script>

</head>

<body onload="getMyData()">

	<h1 align="center">Today in Sofia, Bulgaria</h1>

	<div class="weather">
		<div id="state"></div>
		<div id="curr_temp"></div>
		<div id="max_temp"></div>
		<div id="min_temp"></div>
		<div id="humidity"></div>
	</div>

	<div class="questions">
		<h1>Questions</h1>

		<h2>1. Describe the API you selected and what it does. </h2>
		<p> The API I used ...</p>

		<h2>2. Cite the website where you found it.</h2>
		<p> I found the API on this <a href="https://github.com/public-apis/public-apis#weather">website</a> </p>

		<h2>3. Describe the options you used for the API request</h2>
		<p> The options I used for the API request </p>

		<h2>4. Give two applications where this API would be helpful.</h2>
		<p> Two applications where this API would be helpful...</p>
	</div>


</body>
